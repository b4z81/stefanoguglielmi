{"version":3,"sources":["grid/main.js"],"names":["window","getComputedTranslateY","obj","getComputedStyle","style","transform","webkitTransform","mozTransform","mat","match","parseFloat","split","scrollY","pageYOffset","docElem","scrollTop","extend","a","b","key","hasOwnProperty","IsoGrid","el","options","this","isolayerEl","gridEl","querySelector","gridItems","slice","call","querySelectorAll","gridItemsTotal","length","didscroll","_init","prefix","lastTime","prefixes","requestAnimationFrame","cancelAnimationFrame","i","callback","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","document","documentElement","prototype","type","perspective","stackItemsAnimation","properties","pos","translateZ","itemstotal","dynamics","bezier","duration","points","x","y","cp","onGridLoaded","self","imagesLoaded","msnry","Masonry","itemSelector","isFitWidth","position","WebkitTransformStyle","transformStyle","transformValue","WebkitTransform","_createPseudoScroller","_initEvents","AnimOnScroll","minDuration","maxDuration","viewportFactor","classie","add","pseudoScrollerEl","createElement","className","parentNode","insertBefore","height","offsetHeight","sqrt","scrollHandler","_scrollPage","mouseenterHandler","ev","_expandSubItems","target","mouseleaveHandler","_collapseSubItems","addEventListener","on","laidOutItems","offsetTop","forEach","item","itemLink","subItems","subItemsTotal","zIndex","subitem","stop","animate","complete"],"mappings":"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","file":"grid/main.js","sourcesContent":["/**\n * main.js\n * http://www.codrops.com\n *\n * Licensed under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n * \n * Copyright 2016, Codrops\n * http://www.codrops.com\n */\n;(function(window) {\n\n\t'use strict';\n\n\t// from: http://stackoverflow.com/a/21913575\n\tfunction getComputedTranslateY(obj) {\n\t\tif(!window.getComputedStyle) return;\n\t\tvar style = getComputedStyle(obj),\n\t\t\ttransform = style.transform || style.webkitTransform || style.mozTransform;\n\t\tvar mat = transform.match(/^matrix3d\\((.+)\\)$/);\n\t\tif(mat) return parseFloat(mat[1].split(', ')[13]);\n\t\tmat = transform.match(/^matrix\\((.+)\\)$/);\n\t\treturn mat ? parseFloat(mat[1].split(', ')[5]) : 0;\n\t}\n\n\t/**********************************************/\n\t/** https://gist.github.com/desandro/1866474 **/\n\t/**********************************************/\n\tvar lastTime = 0;\n\tvar prefixes = 'webkit moz ms o'.split(' ');\n\t// get unprefixed rAF and cAF, if present\n\tvar requestAnimationFrame = window.requestAnimationFrame;\n\tvar cancelAnimationFrame = window.cancelAnimationFrame;\n\t// loop through vendor prefixes and get prefixed rAF and cAF\n\tvar prefix;\n\tfor( var i = 0; i < prefixes.length; i++ ) {\n\t\tif ( requestAnimationFrame && cancelAnimationFrame ) {\n\t\t\tbreak;\n\t\t}\n\t\tprefix = prefixes[i];\n\t\trequestAnimationFrame = requestAnimationFrame || window[ prefix + 'RequestAnimationFrame' ];\n\t\tcancelAnimationFrame  = cancelAnimationFrame  || window[ prefix + 'CancelAnimationFrame' ] ||\n\t\twindow[ prefix + 'CancelRequestAnimationFrame' ];\n\t}\n\n\t// fallback to setTimeout and clearTimeout if either request/cancel is not supported\n\tif ( !requestAnimationFrame || !cancelAnimationFrame ) {\n\t\trequestAnimationFrame = function( callback, element ) {\n\t\t\tvar currTime = new Date().getTime();\n\t\t\tvar timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n\t\t\tvar id = window.setTimeout( function() {\n\t\t\t\tcallback( currTime + timeToCall );\n\t\t\t}, timeToCall );\n\t\t\tlastTime = currTime + timeToCall;\n\t\t\treturn id;\n\t\t};\n\n\t\tcancelAnimationFrame = function( id ) {\n\t\t\twindow.clearTimeout( id );\n\t\t};\n\t}\n\t/**********************************************/\n\t/** https://gist.github.com/desandro/1866474 **/\n\t/**********************************************/\n\n\tvar docElem = window.document.documentElement;\n\t\n\t// some helper functions\n\tfunction scrollY() { return window.pageYOffset || docElem.scrollTop; }\n\tfunction extend( a, b ) {\n\t\tfor( var key in b ) { \n\t\t\tif( b.hasOwnProperty( key ) ) {\n\t\t\t\ta[key] = b[key];\n\t\t\t}\n\t\t}\n\t\treturn a;\n\t}\n\t\n\t/**\n\t * Isometric grid obj\n\t */\n\tfunction IsoGrid(el, options) {\n\t\tthis.isolayerEl = el;\n\t\t\n\t\tthis.options = extend( {}, this.options );\n\t\textend( this.options, options );\n\n\t\tthis.gridEl = this.isolayerEl.querySelector('.grid');\n\n\t\t// grid items\n\t\tthis.gridItems = [].slice.call(this.gridEl.querySelectorAll('.grid__item'));\n\t\tthis.gridItemsTotal = this.gridItems.length;\n\t\t\n\t\tthis.didscroll = false;\n\n\t\tthis._init();\n\t}\n\n\tIsoGrid.prototype.options = {\n\t\t// static or scrollable\n\t\ttype: 'static',\n\t\t// grid perspective value\n\t\tperspective: 0,\n\t\t// grid transform\n\t\ttransform: '',\n\t\t// each grid item animation (for the subitems)\n\t\tstackItemsAnimation : {\n\t\t\t// this follows the dynamics.js (https://github.com/michaelvillar/dynamics.js) animate fn syntax\n\t\t\t// properties (pos is the current subitem position)\n\t\t\tproperties : function(pos) {\n\t\t\t\treturn {\n\t\t\t\t\ttranslateZ: (pos+1) * 50\n\t\t\t\t};\n\t\t\t},\n\t\t\t// animation options (pos is the current subitem position); itemstotal is the total number of subitems\n\t\t\toptions : function(pos, itemstotal) {\n\t\t\t\treturn {\n\t\t\t\t\ttype: dynamics.bezier,\n\t\t\t\t\tduration: 500,\n\t\t\t\t\tpoints: [{\"x\":0,\"y\":0,\"cp\":[{\"x\":0.2,\"y\":1}]},{\"x\":1,\"y\":1,\"cp\":[{\"x\":0.3,\"y\":1}]}]\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\t// callback for loaded grid\n\t\tonGridLoaded : function() { return false; }\t\n\t};\n\n\tIsoGrid.prototype._init = function() {\n\t\tvar self = this;\n\n\t\timagesLoaded(this.gridEl, function() {\n\t\t\t// initialize masonry\n\t\t\tself.msnry = new Masonry(self.gridEl, {\n\t\t\t\titemSelector: '.grid__item',\n\t\t\t\tisFitWidth : true\n\t\t\t});\n\t\t\t\n\t\t\t// the isolayer div element will be positioned fixed and will have a transformation based on the values defined in the HTML (data-attrs for the isolayer div element)\n\t\t\tif( self.options.type === 'scrollable' ) {\n\t\t\t\tself.isolayerEl.style.position = 'fixed';\t\n\t\t\t}\n\t\t\t\n\t\t\tself.isolayerEl.style.WebkitTransformStyle = self.isolayerEl.style.transformStyle = 'preserve-3d';\n\n\t\t\tvar transformValue = self.options.perspective != 0 ? 'perspective(' + self.options.perspective + 'px) ' + self.options.transform : self.options.transform;\n\t\t\tself.isolayerEl.style.WebkitTransform = self.isolayerEl.style.transform = transformValue;\n\t\t\t\n\t\t\t// create the div element that will force the height for scrolling\n\t\t\tif( self.options.type === 'scrollable' ) {\n\t\t\t\tself._createPseudoScroller();\n\t\t\t}\n\t\t\t\n\t\t\t// init/bind events\n\t\t\tself._initEvents();\n\n\t\t\t// effects for loading grid elements:\n\t\t\tif( self.options.type === 'scrollable' ) {\n\t\t\t\tnew AnimOnScroll(self.gridEl, {\n\t\t\t\t\tminDuration : 1,\n\t\t\t\t\tmaxDuration : 1.2,\n\t\t\t\t\tviewportFactor : 0\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// grid is \"loaded\" (all images are loaded)\n\t\t\tself.options.onGridLoaded();\n\t\t\tclassie.add(self.gridEl, 'grid--loaded');\n\t\t});\n\t};\n\n\t/**\n\t * Creates the div element that will force the height for scrolling\n\t */\n\tIsoGrid.prototype._createPseudoScroller = function() {\n\t\t// element that will force the height for scrolling\n\t\tthis.pseudoScrollerEl = document.createElement('div');\n\t\tthis.pseudoScrollerEl.className = 'pseudo-scroller';\n\t\t// insert it inside the main container (same level of isolayerEl)\n\t\tthis.isolayerEl.parentNode.insertBefore(this.pseudoScrollerEl, this.isolayerEl);\n\t\t// set the height of the pseudoScroller (grid´s height + additional space between the top of the rotated isolayerEl and the page - value set for the translation on the Y axis)\n\t\tthis.pseudoScrollerEl.style.height = this.gridEl.offsetHeight + getComputedTranslateY(this.isolayerEl) * Math.sqrt(2) + 'px';\t\n\t};\n\n\t/**\n\t * Initialize/Bind events fn.\n\t */\n\tIsoGrid.prototype._initEvents = function() {\n\t\tvar self = this;\n\n\t\tvar scrollHandler = function() {\n\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\tif (!self.didscroll) {\n\t\t\t\t\t\tself.didscroll = true;\n\t\t\t\t\t\tself._scrollPage();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tmouseenterHandler = function(ev) {\n\t\t\t\tself._expandSubItems(ev.target);\n\t\t\t},\n\t\t\tmouseleaveHandler = function(ev) {\n\t\t\t\tself._collapseSubItems(ev.target);\n\t\t\t};\n\n\t\tif( this.options.type === 'scrollable' ) {\n\t\t\t// update the transform (ty) on scroll\n\t\t\twindow.addEventListener('scroll', scrollHandler, false);\n\t\t\t// on resize (layoutComplete for the masonry instance) recalculate height\n\t\t\tthis.msnry.on('layoutComplete', function( laidOutItems ) {\n\t\t\t\t// reset the height of the pseudoScroller (grid´s height + additional space between the top of the rotated isolayerEl and the page)\n\t\t\t\tself.pseudoScrollerEl.style.height = self.gridEl.offsetHeight + self.isolayerEl.offsetTop * Math.sqrt(2) + 'px';\n\t\t\t\tself._scrollPage();\n\t\t\t});\n\t\t}\n\n\t\tthis.gridItems.forEach(function(item) {\n\t\t\titem.addEventListener('mouseenter', mouseenterHandler);\n\t\t\titem.addEventListener('mouseleave', mouseleaveHandler);\n\t\t});\n\t};\n\n\tIsoGrid.prototype._expandSubItems = function(item) {\n\t\tvar self = this,\n\t\t\titemLink = item.querySelector('a'),\n\t\t\tsubItems = [].slice.call(itemLink.querySelectorAll('.layer')), \n\t\t\tsubItemsTotal = subItems.length;\n\n\t\titemLink.style.zIndex = item.style.zIndex = this.gridItemsTotal;\n\t\t\n\t\tsubItems.forEach(function(subitem, pos) {\n\t\t\tdynamics.stop(subitem);\n\t\t\tdynamics.animate(subitem, self.options.stackItemsAnimation.properties(pos), self.options.stackItemsAnimation.options(pos, subItemsTotal));\n\t\t});\n\t};\n\n\tIsoGrid.prototype._collapseSubItems = function(item) {\n\t\tvar itemLink = item.querySelector('a');\n\t\t[].slice.call(itemLink.querySelectorAll('.layer')).forEach(function(subitem, pos) {\n\t\t\tdynamics.stop(subitem);\n\t\t\tdynamics.animate(subitem, {\n\t\t\t\ttranslateZ: 0 // enough to reset any transform value previously set\n\t\t\t}, {\n\t\t\t\tduration: 100,\n\t\t\t\tcomplete: function() {\n\t\t\t\t\titemLink.style.zIndex = item.style.zIndex = 1;\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t};\n\n\tIsoGrid.prototype._scrollPage = function() {\n\t\tthis.gridEl.style.WebkitTransform = this.gridEl.style.transform = 'translate3d(0,-' + scrollY() + 'px,0)';\n\t\tthis.didscroll = false;\n\t};\n\n\twindow.IsoGrid = IsoGrid;\n\n})(window);"],"sourceRoot":"/source/"}